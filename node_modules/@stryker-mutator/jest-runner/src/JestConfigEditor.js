"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const CustomJestConfigLoader_1 = tslib_1.__importDefault(require("./configLoaders/CustomJestConfigLoader"));
const ReactScriptsJestConfigLoader_1 = tslib_1.__importDefault(require("./configLoaders/ReactScriptsJestConfigLoader"));
const ReactScriptsTSJestConfigLoader_1 = tslib_1.__importDefault(require("./configLoaders/ReactScriptsTSJestConfigLoader"));
const jestOverrideOptions_1 = tslib_1.__importDefault(require("./jestOverrideOptions"));
const DEFAULT_PROJECT_NAME = 'custom';
class JestConfigEditor {
    edit(strykerConfig) {
        // If there is no Jest property on the Stryker config create it
        strykerConfig.jest = strykerConfig.jest || {};
        // When no projectType is set, set it to the default
        strykerConfig.jest.projectType = strykerConfig.jest.projectType || strykerConfig.jest.project || DEFAULT_PROJECT_NAME;
        // When no config property is set, load the configuration with the project type
        strykerConfig.jest.config = strykerConfig.jest.config || this.getConfigLoader(strykerConfig.jest.projectType).loadConfig();
        // Override some of the config properties to optimise Jest for Stryker
        strykerConfig.jest.config = this.overrideProperties(strykerConfig.jest.config);
    }
    getConfigLoader(projectType) {
        switch (projectType.toLowerCase()) {
            case DEFAULT_PROJECT_NAME:
                return new CustomJestConfigLoader_1.default(process.cwd());
            case 'react':
                return new ReactScriptsJestConfigLoader_1.default(process.cwd());
            case 'react-ts':
                return new ReactScriptsTSJestConfigLoader_1.default(process.cwd());
            default:
                throw new Error(`No configLoader available for ${projectType}`);
        }
    }
    overrideProperties(config) {
        return Object.assign(config, jestOverrideOptions_1.default);
    }
}
exports.default = JestConfigEditor;
//# sourceMappingURL=JestConfigEditor.js.map
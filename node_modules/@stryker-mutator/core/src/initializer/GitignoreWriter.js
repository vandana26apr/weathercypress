"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const os = require("os");
const plugin_1 = require("@stryker-mutator/api/plugin");
const util_1 = require("@stryker-mutator/util");
const config_1 = require("@stryker-mutator/api/config");
const _1 = require(".");
const GITIGNORE_FILE = '.gitignore';
class GitignoreWriter {
    constructor(out) {
        this.out = out;
    }
    async addStrykerTempFolder() {
        if (util_1.fsAsPromised.existsSync(GITIGNORE_FILE)) {
            const gitignoreContent = await util_1.fsAsPromised.readFile(GITIGNORE_FILE);
            if (!gitignoreContent.toString().includes(config_1.defaultTempDirName)) {
                const strykerTempFolderSpecification = `${os.EOL}# stryker temp files${os.EOL}${config_1.defaultTempDirName}${os.EOL}`;
                await util_1.fsAsPromised.appendFile(GITIGNORE_FILE, strykerTempFolderSpecification);
                this.out('Note: Your .gitignore file has been updated to include recommended git ignore patterns for Stryker');
            }
        }
        else {
            this.out('No .gitignore file could be found. Please add the following to your .gitignore file: *.stryker-tmp');
        }
    }
}
exports.default = GitignoreWriter;
GitignoreWriter.inject = plugin_1.tokens(_1.initializerTokens.out);
//# sourceMappingURL=GitignoreWriter.js.map